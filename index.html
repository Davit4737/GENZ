<script>
  // Ensure nav Buy opens modal and other nav links behave normally on touch devices.
  (function(){
    // Safe guard: openBuyModal must exist (из твоего кода)
    const maybeOpen = window.openBuyModal || window.openBuyModal || null;

    // Attach click/touch handlers to nav links
    document.querySelectorAll('#mainNav .nav-link').forEach(link=>{
      // if it's the Buy button — open modal
      if (link.getAttribute('href') === '#buy' || link.id === 'navBuy'){
        const handler = (e) => {
          e.preventDefault();
          // try to call existing openBuyModal, fallback: scroll to #buy
          if (typeof openBuyModal === 'function') {
            openBuyModal({ autoTier: null });
          } else {
            const target = document.getElementById('buy');
            if (target) target.scrollIntoView({behavior:'smooth'});
          }
        };
        link.addEventListener('click', handler, {passive:false});
        link.addEventListener('touchend', handler, {passive:false});
      } else {
        // normal nav links — ensure touch opens (prevent accidental hover-only behavior)
        link.addEventListener('click', (e)=>{ /* default — follow anchor */ }, {passive:true});
        link.addEventListener('touchend', (e)=>{ /* allow native anchoring */ }, {passive:true});
      }
    });

    // Also ensure existing buy buttons (#seedBuy, #earlyBuy, #publicBuy) still open modal on touch
    ['seedBuy','earlyBuy','publicBuy'].forEach(id=>{
      const btn = document.getElementById(id);
      if (!btn) return;
      const handler = (e) => { e.preventDefault(); if (typeof openBuyModal === 'function') openBuyModal({ autoTier: id === 'seedBuy' ? 'seed' : id === 'earlyBuy' ? 'early' : 'public' }); };
      btn.removeEventListener && btn.removeEventListener('click', handler);
      btn.addEventListener('click', handler, {passive:false});
      btn.addEventListener('touchend', handler, {passive:false});
    });

    // Small safety: if CSS previously hid nav, force visible
    const nav = document.getElementById('mainNav');
    if (nav) {
      nav.style.display = 'flex';
      nav.style.visibility = 'visible';
    }

    console.log('NAV: mobile touch handlers attached');
  })();
</script>
